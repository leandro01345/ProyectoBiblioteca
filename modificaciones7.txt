CREATE OR REPLACE PROCEDURE  PRO_ADD_SOLICITUD (
 id_usuario   SOLICITUD.USUARIO_IDUSUARIO%TYPE
 ) IS
BEGIN
   INSERT INTO SOLICITUD(USUARIO_IDUSUARIO, IDSOLICITUD, FECHASOLICITUD, HORASOLICITUD) 	
   VALUES(id_usuario, SEQ_SOLICITUD.NEXTVAL, current_timestamp, current_timestamp);
END;

insert into sesion
values (seq_sesion.nextval,'biblio','3244185981728979115075721453575112','bibliotecario');

insert into sesion
values (seq_sesion.nextval,'superadmin','3244185981728979115075721453575112','superadmin');

insert into sesion
values (seq_sesion.nextval,'Juanito','3244185981728979115075721453575112','usuario');

ALTER TABLE EJEMPLAR
ADD DISPONIBILIDAD VARCHAR2 (50);

create or replace view v_catalogo as
select D.IDDOCUMENTO, D.TITULODOCUMENTO, D.AUTORDOCUMENTO, D.EDICIONDOCUMENTO, D.ANIODOCUMENTO, D.TIPODOCUMENTO, D.CATEGORIADOCUMENTO, D.EDITORIALDOCUMENTO,
(SELECT COUNT(*) FROM EJEMPLAR E JOIN DOCUMENTO DO ON E.DOCUMENTO_IDDOCUMENTO = DO.IDDOCUMENTO WHERE E.DOCUMENTO_IDDOCUMENTO = D.IDDOCUMENTO) AS CANTIDAD,
(SELECT COUNT(*) FROM EJEMPLAR E JOIN DOCUMENTO DO ON E.DOCUMENTO_IDDOCUMENTO = DO.IDDOCUMENTO WHERE E.DOCUMENTO_IDDOCUMENTO = D.IDDOCUMENTO AND E.DISPONIBILIDAD = 'disponible') AS DISPONIBLES
from DOCUMENTO D;

CREATE OR REPLACE PROCEDURE  PRO_ADD_EJEMPLAR (
 id_documento      EJEMPLAR.DOCUMENTO_IDDOCUMENTO%TYPE,
 estado_ejemplar   EJEMPLAR.ESTADOEJEMPLAR%TYPE,
 ubicacion_ejemplar EJEMPLAR.UBICACIONEJEMPLAR%TYPE) IS
BEGIN
   INSERT INTO EJEMPLAR(IDEJEMPLAR,DOCUMENTO_IDDOCUMENTO,ESTADOEJEMPLAR, UBICACIONEJEMPLAR, DISPONIBILIDAD) 	VALUES(SEQ_EJEMPLAR.NEXTVAL, id_documento, estado_ejemplar, ubicacion_ejemplar,'disponible');
 DBMS_OUTPUT.PUT_LINE(' Filas insertadas: '||SQL%ROWCOUNT);
END;

commit;